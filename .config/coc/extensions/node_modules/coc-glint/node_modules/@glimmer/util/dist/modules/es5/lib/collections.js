function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

import { ensureGuid } from './guid';
export function dict() {
  return Object.create(null);
}
export function isDict(u) {
  return u !== null && u !== undefined;
}
export function isObject(u) {
  return typeof u === 'object' && u !== null;
}
export var DictSet = /*#__PURE__*/function () {
  function DictSet() {
    this.dict = dict();
  }

  var _proto = DictSet.prototype;

  _proto.add = function add(obj) {
    if (typeof obj === 'string') this.dict[obj] = obj;else this.dict[ensureGuid(obj)] = obj;
    return this;
  };

  _proto["delete"] = function _delete(obj) {
    if (typeof obj === 'string') delete this.dict[obj];else if (obj._guid) delete this.dict[obj._guid];
  };

  return DictSet;
}();
export var StackImpl = /*#__PURE__*/function () {
  function StackImpl(values) {
    if (values === void 0) {
      values = [];
    }

    this.current = null;
    this.stack = values;
  }

  var _proto2 = StackImpl.prototype;

  _proto2.push = function push(item) {
    this.current = item;
    this.stack.push(item);
  };

  _proto2.pop = function pop() {
    var item = this.stack.pop();
    var len = this.stack.length;
    this.current = len === 0 ? null : this.stack[len - 1];
    return item === undefined ? null : item;
  };

  _proto2.nth = function nth(from) {
    var len = this.stack.length;
    return len < from ? null : this.stack[len - from];
  };

  _proto2.isEmpty = function isEmpty() {
    return this.stack.length === 0;
  };

  _proto2.toArray = function toArray() {
    return this.stack;
  };

  _createClass(StackImpl, [{
    key: "size",
    get: function get() {
      return this.stack.length;
    }
  }]);

  return StackImpl;
}();
export var NonemptyStackImpl = /*#__PURE__*/function () {
  function NonemptyStackImpl(values) {
    this.stack = values;
    this.current = values[values.length - 1];
  }

  var _proto3 = NonemptyStackImpl.prototype;

  _proto3.push = function push(item) {
    this.current = item;
    this.stack.push(item);
  };

  _proto3.pop = function pop() {
    if (this.stack.length === 1) {
      throw new Error("cannot pop the last element of a NonemptyStack");
    }

    var item = this.stack.pop();
    var len = this.stack.length;
    this.current = this.stack[len - 1];
    return item;
  };

  _proto3.nth = function nth(from) {
    var len = this.stack.length;
    return from >= len ? null : this.stack[from];
  };

  _proto3.nthBack = function nthBack(from) {
    var len = this.stack.length;
    return len < from ? null : this.stack[len - from];
  };

  _proto3.toArray = function toArray() {
    return this.stack;
  };

  _createClass(NonemptyStackImpl, [{
    key: "size",
    get: function get() {
      return this.stack.length;
    }
  }]);

  return NonemptyStackImpl;
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3V0aWwvbGliL2NvbGxlY3Rpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxTQUFBLFVBQUEsUUFBQSxRQUFBO0FBT0EsT0FBTSxTQUFBLElBQUEsR0FBYztBQUNsQixTQUFPLE1BQU0sQ0FBTixNQUFBLENBQVAsSUFBTyxDQUFQO0FBQ0Q7QUFFRCxPQUFNLFNBQUEsTUFBQSxDQUFBLENBQUEsRUFBd0I7QUFDNUIsU0FBTyxDQUFDLEtBQUQsSUFBQSxJQUFjLENBQUMsS0FBdEIsU0FBQTtBQUNEO0FBRUQsT0FBTSxTQUFBLFFBQUEsQ0FBQSxDQUFBLEVBQTBCO0FBQzlCLFNBQU8sT0FBQSxDQUFBLEtBQUEsUUFBQSxJQUF5QixDQUFDLEtBQWpDLElBQUE7QUFDRDtBQUlELFdBQU0sT0FBTjtBQUdFLHFCQUFBO0FBQ0UsU0FBQSxJQUFBLEdBQVksSUFBWixFQUFBO0FBQ0Q7O0FBTEg7O0FBQUEsU0FPRSxHQVBGLEdBT0UsYUFBRyxHQUFILEVBQVU7QUFDUixRQUFJLE9BQUEsR0FBQSxLQUFKLFFBQUEsRUFBNkIsS0FBQSxJQUFBLENBQUEsR0FBQSxJQUE3QixHQUE2QixDQUE3QixLQUNLLEtBQUEsSUFBQSxDQUFVLFVBQVUsQ0FBcEIsR0FBb0IsQ0FBcEIsSUFBQSxHQUFBO0FBQ0wsV0FBQSxJQUFBO0FBQ0QsR0FYSDs7QUFBQSxxQkFhRSxpQkFBTSxHQUFOLEVBQWE7QUFDWCxRQUFJLE9BQUEsR0FBQSxLQUFKLFFBQUEsRUFBNkIsT0FBTyxLQUFBLElBQUEsQ0FBcEMsR0FBb0MsQ0FBUCxDQUE3QixLQUNLLElBQUssR0FBVyxDQUFoQixLQUFBLEVBQXdCLE9BQU8sS0FBQSxJQUFBLENBQVcsR0FBVyxDQUE3QixLQUFPLENBQVA7QUFDOUIsR0FoQkg7O0FBQUE7QUFBQTtBQW1CQSxXQUFNLFNBQU47QUFJRSxxQkFBWSxNQUFaLEVBQTRCO0FBQUEsUUFBaEIsTUFBZ0I7QUFBaEIs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QUFQLE1BQUE7QUFDRDtBQVhIOztBQUFBO0FBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaWN0LCBOb25lbXB0eVN0YWNrLCBPcHRpb24sIFN0YWNrIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBlbnN1cmVHdWlkLCBIYXNHdWlkIH0gZnJvbSAnLi9ndWlkJztcblxuZXhwb3J0IGludGVyZmFjZSBTZXQ8VD4ge1xuICBhZGQodmFsdWU6IFQpOiBTZXQ8VD47XG4gIGRlbGV0ZSh2YWx1ZTogVCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWN0PFQgPSB1bmtub3duPigpOiBEaWN0PFQ+IHtcbiAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0RpY3Q8VD4odTogVCk6IHUgaXMgRGljdCAmIFQge1xuICByZXR1cm4gdSAhPT0gbnVsbCAmJiB1ICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdDxUPih1OiBUKTogdSBpcyBvYmplY3QgJiBUIHtcbiAgcmV0dXJuIHR5cGVvZiB1ID09PSAnb2JqZWN0JyAmJiB1ICE9PSBudWxsO1xufVxuXG5leHBvcnQgdHlwZSBTZXRNZW1iZXIgPSBIYXNHdWlkIHwgc3RyaW5nO1xuXG5leHBvcnQgY2xhc3MgRGljdFNldDxUIGV4dGVuZHMgU2V0TWVtYmVyPiBpbXBsZW1lbnRzIFNldDxUPiB7XG4gIHByaXZhdGUgZGljdDogRGljdDxUPjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRpY3QgPSBkaWN0PFQ+KCk7XG4gIH1cblxuICBhZGQob2JqOiBUKTogU2V0PFQ+IHtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIHRoaXMuZGljdFtvYmogYXMgYW55XSA9IG9iajtcbiAgICBlbHNlIHRoaXMuZGljdFtlbnN1cmVHdWlkKG9iaiBhcyBhbnkpXSA9IG9iajtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRlbGV0ZShvYmo6IFQpIHtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIGRlbGV0ZSB0aGlzLmRpY3Rbb2JqIGFzIGFueV07XG4gICAgZWxzZSBpZiAoKG9iaiBhcyBhbnkpLl9ndWlkKSBkZWxldGUgdGhpcy5kaWN0WyhvYmogYXMgYW55KS5fZ3VpZF07XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0YWNrSW1wbDxUPiBpbXBsZW1lbnRzIFN0YWNrPFQ+IHtcbiAgcHJpdmF0ZSBzdGFjazogVFtdO1xuICBwdWJsaWMgY3VycmVudDogT3B0aW9uPFQ+ID0gbnVsbDtcblxuICBjb25zdHJ1Y3Rvcih2YWx1ZXM6IFRbXSA9IFtdKSB7XG4gICAgdGhpcy5zdGFjayA9IHZhbHVlcztcbiAgfVxuXG4gIHB1YmxpYyBnZXQgc2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGFjay5sZW5ndGg7XG4gIH1cblxuICBwdXNoKGl0ZW06IFQpIHtcbiAgICB0aGlzLmN1cnJlbnQgPSBpdGVtO1xuICAgIHRoaXMuc3RhY2sucHVzaChpdGVtKTtcbiAgfVxuXG4gIHBvcCgpOiBPcHRpb248VD4ge1xuICAgIGxldCBpdGVtID0gdGhpcy5zdGFjay5wb3AoKTtcbiAgICBsZXQgbGVuID0gdGhpcy5zdGFjay5sZW5ndGg7XG4gICAgdGhpcy5jdXJyZW50ID0gbGVuID09PSAwID8gbnVsbCA6IHRoaXMuc3RhY2tbbGVuIC0gMV07XG5cbiAgICByZXR1cm4gaXRlbSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGl0ZW07XG4gIH1cblxuICBudGgoZnJvbTogbnVtYmVyKTogT3B0aW9uPFQ+IHtcbiAgICBsZXQgbGVuID0gdGhpcy5zdGFjay5sZW5ndGg7XG4gICAgcmV0dXJuIGxlbiA8IGZyb20gPyBudWxsIDogdGhpcy5zdGFja1tsZW4gLSBmcm9tXTtcbiAgfVxuXG4gIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2subGVuZ3RoID09PSAwO1xuICB9XG5cbiAgdG9BcnJheSgpOiBUW10ge1xuICAgIHJldHVybiB0aGlzLnN0YWNrO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOb25lbXB0eVN0YWNrSW1wbDxUPiBpbXBsZW1lbnRzIE5vbmVtcHR5U3RhY2s8VD4ge1xuICBwcml2YXRlIHN0YWNrOiBbVCwgLi4uVFtdXTtcbiAgcHVibGljIGN1cnJlbnQ6IFQ7XG5cbiAgY29uc3RydWN0b3IodmFsdWVzOiBbVCwgLi4uVFtdXSkge1xuICAgIHRoaXMuc3RhY2sgPSB2YWx1ZXM7XG4gICAgdGhpcy5jdXJyZW50ID0gdmFsdWVzW3ZhbHVlcy5sZW5ndGggLSAxXTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgc2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGFjay5sZW5ndGg7XG4gIH1cblxuICBwdXNoKGl0ZW06IFQpIHtcbiAgICB0aGlzLmN1cnJlbnQgPSBpdGVtO1xuICAgIHRoaXMuc3RhY2sucHVzaChpdGVtKTtcbiAgfVxuXG4gIHBvcCgpOiBUIHtcbiAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPT09IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgY2Fubm90IHBvcCB0aGUgbGFzdCBlbGVtZW50IG9mIGEgTm9uZW1wdHlTdGFja2ApO1xuICAgIH1cblxuICAgIGxldCBpdGVtID0gdGhpcy5zdGFjay5wb3AoKSE7XG4gICAgbGV0IGxlbiA9IHRoaXMuc3RhY2subGVuZ3RoO1xuICAgIHRoaXMuY3VycmVudCA9IHRoaXMuc3RhY2tbbGVuIC0gMV07XG5cbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuXG4gIG50aChmcm9tOiAwKTogVDtcbiAgbnRoKGZyb206IG51bWJlcik6IE9wdGlvbjxUPjtcbiAgbnRoKGZyb206IG51bWJlcik6IE9wdGlvbjxUPiB7XG4gICAgbGV0IGxlbiA9IHRoaXMuc3RhY2subGVuZ3RoO1xuICAgIHJldHVybiBmcm9tID49IGxlbiA/IG51bGwgOiB0aGlzLnN0YWNrW2Zyb21dO1xuICB9XG5cbiAgbnRoQmFjayhmcm9tOiBudW1iZXIpOiBPcHRpb248VD4ge1xuICAgIGxldCBsZW4gPSB0aGlzLnN0YWNrLmxlbmd0aDtcbiAgICByZXR1cm4gbGVuIDwgZnJvbSA/IG51bGwgOiB0aGlzLnN0YWNrW2xlbiAtIGZyb21dO1xuICB9XG5cbiAgdG9BcnJheSgpOiBbVCwgLi4uVFtdXSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2s7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=