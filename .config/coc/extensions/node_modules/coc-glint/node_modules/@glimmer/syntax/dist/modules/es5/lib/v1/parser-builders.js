import { assert } from '@glimmer/util';
import { PathExpressionImplV1 } from './legacy-interop';
var DEFAULT_STRIP = {
  close: false,
  open: false
};
/**
 * The Parser Builder differentiates from the public builder API by:
 *
 * 1. Offering fewer different ways to instantiate nodes
 * 2. Mandating source locations
 */

var Builders = /*#__PURE__*/function () {
  function Builders() {}

  var _proto = Builders.prototype;

  _proto.pos = function pos(line, column) {
    return {
      line: line,
      column: column
    };
  };

  _proto.blockItself = function blockItself(_ref) {
    var body = _ref.body,
        blockParams = _ref.blockParams,
        _ref$chained = _ref.chained,
        chained = _ref$chained === void 0 ? false : _ref$chained,
        loc = _ref.loc;
    return {
      type: 'Block',
      body: body || [],
      blockParams: blockParams || [],
      chained: chained,
      loc: loc
    };
  };

  _proto.template = function template(_ref2) {
    var body = _ref2.body,
        blockParams = _ref2.blockParams,
        loc = _ref2.loc;
    return {
      type: 'Template',
      body: body || [],
      blockParams: blockParams || [],
      loc: loc
    };
  };

  _proto.mustache = function mustache(_ref3) {
    var path = _ref3.path,
        params = _ref3.params,
        hash = _ref3.hash,
        trusting = _ref3.trusting,
        loc = _ref3.loc,
        _ref3$strip = _ref3.strip,
        strip = _ref3$strip === void 0 ? DEFAULT_STRIP : _ref3$strip;
    return {
      type: 'MustacheStatement',
      path: path,
      params: params,
      hash: hash,
      escaped: !trusting,
      trusting: trusting,
      loc: loc,
      strip: strip || {
        open: false,
        close: false
      }
    };
  };

  _proto.block = function block(_ref4) {
    var path = _ref4.path,
        params = _ref4.params,
        hash = _ref4.hash,
        defaultBlock = _ref4.defaultBlock,
        _ref4$elseBlock = _ref4.elseBlock,
        elseBlock = _ref4$elseBlock === void 0 ? null : _ref4$elseBlock,
        loc = _ref4.loc,
        _ref4$openStrip = _ref4.openStrip,
        openStrip = _ref4$openStrip === void 0 ? DEFAULT_STRIP : _ref4$openStrip,
        _ref4$inverseStrip = _ref4.inverseStrip,
        inverseStrip = _ref4$inverseStrip === void 0 ? DEFAULT_STRIP : _ref4$inverseStrip,
        _ref4$closeStrip = _ref4.closeStrip,
        closeStrip = _ref4$closeStrip === void 0 ? DEFAULT_STRIP : _ref4$closeStrip;
    return {
      type: 'BlockStatement',
      path: path,
      params: params,
      hash: hash,
      program: defaultBlock,
      inverse: elseBlock,
      loc: loc,
      openStrip: openStrip,
      inverseStrip: inverseStrip,
      closeStrip: closeStrip
    };
  };

  _proto.comment = function comment(value, loc) {
    return {
      type: 'CommentStatement',
      value: value,
      loc: loc
    };
  };

  _proto.mustacheComment = function mustacheComment(value, loc) {
    return {
      type: 'MustacheCommentStatement',
      value: value,
      loc: loc
    };
  };

  _proto.concat = function concat(parts, loc) {
    return {
      type: 'ConcatStatement',
      parts: parts,
      loc: loc
    };
  };

  _proto.element = function element(_ref5) {
    var tag = _ref5.tag,
        selfClosing = _ref5.selfClosing,
        attrs = _ref5.attrs,
        blockParams = _ref5.blockParams,
        modifiers = _ref5.modifiers,
        comments = _ref5.comments,
        children = _ref5.children,
        loc = _ref5.loc;
    return {
      type: 'ElementNode',
      tag: tag,
      selfClosing: selfClosing,
      attributes: attrs || [],
      blockParams: blockParams || [],
      modifiers: modifiers || [],
      comments: comments || [],
      children: children || [],
      loc: loc
    };
  };

  _proto.elementModifier = function elementModifier(_ref6) {
    var path = _ref6.path,
        params = _ref6.params,
        hash = _ref6.hash,
        loc = _ref6.loc;
    return {
      type: 'ElementModifierStatement',
      path: path,
      params: params,
      hash: hash,
      loc: loc
    };
  };

  _proto.attr = function attr(_ref7) {
    var name = _ref7.name,
        value = _ref7.value,
        loc = _ref7.loc;
    return {
      type: 'AttrNode',
      name: name,
      value: value,
      loc: loc
    };
  };

  _proto.text = function text(_ref8) {
    var chars = _ref8.chars,
        loc = _ref8.loc;
    return {
      type: 'TextNode',
      chars: chars,
      loc: loc
    };
  };

  _proto.sexpr = function sexpr(_ref9) {
    var path = _ref9.path,
        params = _ref9.params,
        hash = _ref9.hash,
        loc = _ref9.loc;
    return {
      type: 'SubExpression',
      path: path,
      params: params,
      hash: hash,
      loc: loc
    };
  };

  _proto.path = function path(_ref10) {
    var head = _ref10.head,
        tail = _ref10.tail,
        loc = _ref10.loc;

    var _headToString = headToString(head),
        originalHead = _headToString.original,
        headParts = _headToString.parts;

    var parts = [].concat(headParts, tail);
    var original = [].concat(originalHead, parts).join('.');
    return new PathExpressionImplV1(original, head, tail, loc);
  };

  _proto.head = function head(_head, loc) {
    if (_head[0] === '@') {
      return this.atName(_head, loc);
    } else if (_head === 'this') {
      return this["this"](loc);
    } else {
      return this["var"](_head, loc);
    }
  };

  _proto["this"] = function _this(loc) {
    return {
      type: 'ThisHead',
      loc: loc
    };
  };

  _proto.atName = function atName(name, loc) {
    // the `@` should be included so we have a complete source range
    false && assert(name[0] === '@', "call builders.at() with a string that starts with '@'");
    return {
      type: 'AtHead',
      name: name,
      loc: loc
    };
  };

  _proto["var"] = function _var(name, loc) {
    false && assert(name !== 'this', "You called builders.var() with 'this'. Call builders.this instead");
    false && assert(name[0] !== '@', "You called builders.var() with '" + name + "'. Call builders.at('" + name + "') instead");
    return {
      type: 'VarHead',
      name: name,
      loc: loc
    };
  };

  _proto.hash = function hash(pairs, loc) {
    return {
      type: 'Hash',
      pairs: pairs || [],
      loc: loc
    };
  };

  _proto.pair = function pair(_ref11) {
    var key = _ref11.key,
        value = _ref11.value,
        loc = _ref11.loc;
    return {
      type: 'HashPair',
      key: key,
      value: value,
      loc: loc
    };
  };

  _proto.literal = function literal(_ref12) {
    var type = _ref12.type,
        value = _ref12.value,
        loc = _ref12.loc;
    return {
      type: type,
      value: value,
      original: value,
      loc: loc
    };
  };

  _proto.undefined = function (_undefined) {
    function undefined() {
      return _undefined.apply(this, arguments);
    }

    undefined.toString = function () {
      return _undefined.toString();
    };

    return undefined;
  }(function () {
    return this.literal({
      type: 'UndefinedLiteral',
      value: undefined
    });
  });

  _proto["null"] = function _null() {
    return this.literal({
      type: 'NullLiteral',
      value: null
    });
  };

  _proto.string = function string(value, loc) {
    return this.literal({
      type: 'StringLiteral',
      value: value,
      loc: loc
    });
  };

  _proto["boolean"] = function boolean(value, loc) {
    return this.literal({
      type: 'BooleanLiteral',
      value: value,
      loc: loc
    });
  };

  _proto.number = function number(value, loc) {
    return this.literal({
      type: 'NumberLiteral',
      value: value,
      loc: loc
    });
  };

  return Builders;
}(); // Expressions


function headToString(head) {
  switch (head.type) {
    case 'AtHead':
      return {
        original: head.name,
        parts: [head.name]
      };

    case 'ThisHead':
      return {
        original: "this",
        parts: []
      };

    case 'VarHead':
      return {
        original: head.name,
        parts: [head.name]
      };
  }
}

export default new Builders();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3N5bnRheC9saWIvdjEvcGFyc2VyLWJ1aWxkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLFNBQUEsTUFBQSxRQUFBLGVBQUE7QUFNQSxTQUFBLG9CQUFBLFFBQUEsa0JBQUE7QUFFQSxJQUFNLGFBQWEsR0FBRztBQUNwQixFQUFBLEtBQUssRUFEZSxLQUFBO0FBRXBCLEVBQUEsSUFBSSxFQUFFO0FBRmMsQ0FBdEI7QUFLQTs7Ozs7OztJQU1BLFE7Ozs7O1NBQ0UsRyxHQUFBLGFBQUcsSUFBSCxFQUFHLE1BQUgsRUFBZ0M7QUFDOUIsV0FBTztBQUNMLE1BQUEsSUFESyxFQUNMLElBREs7QUFFTCxNQUFBLE1BQUEsRUFBQTtBQUZLLEtBQVA7QUFJRCxHOztTQUVELFcsR0FBQSwyQkFVQztBQUFBLFFBVlcsSUFVWCxRQVZXLElBVVg7QUFBQSxRQVZXLFdBVVgsUUFWVyxXQVVYO0FBQUEsNEJBUEMsT0FPRDtBQUFBLFFBUEMsT0FPRCw2QkFWVyxLQVVYO0FBQUEsUUFOQyxHQU1ELFFBTkMsR0FNRDtBQUNDLFdBQU87QUFDTCxNQUFBLElBQUksRUFEQyxPQUFBO0FBRUwsTUFBQSxJQUFJLEVBQUUsSUFBSSxJQUZMLEVBQUE7QUFHTCxNQUFBLFdBQVcsRUFBRSxXQUFXLElBSG5CLEVBQUE7QUFJTCxNQUFBLE9BSkssRUFJTCxPQUpLO0FBS0wsTUFBQSxHQUFBLEVBQUE7QUFMSyxLQUFQO0FBT0QsRzs7U0FFRCxRLEdBQUEseUJBUUM7QUFBQSxRQVJRLElBUVIsU0FSUSxJQVFSO0FBQUEsUUFSUSxXQVFSLFNBUlEsV0FRUjtBQUFBLFFBTEMsR0FLRCxTQUxDLEdBS0Q7QUFDQyxXQUFPO0FBQ0wsTUFBQSxJQUFJLEVBREMsVUFBQTtBQUVMLE1BQUEsSUFBSSxFQUFFLElBQUksSUFGTCxFQUFBO0FBR0wsTUFBQSxXQUFXLEVBQUUsV0FBVyxJQUhuQixFQUFBO0FBSUwsTUFBQSxHQUFBLEVB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LEtBQXpCLEVBQXlCLEtBQXpCO0FBQWdDLE1BQUEsR0FBQSxFQUFBO0FBQWhDLEtBQWIsQ0FBUDtBQUNELEc7OztLQThDSDs7O0FBRUEsU0FBQSxZQUFBLENBQUEsSUFBQSxFQUEwQztBQUN4QyxVQUFRLElBQUksQ0FBWixJQUFBO0FBQ0UsU0FBQSxRQUFBO0FBQ0UsYUFBTztBQUFFLFFBQUEsUUFBUSxFQUFFLElBQUksQ0FBaEIsSUFBQTtBQUF1QixRQUFBLEtBQUssRUFBRSxDQUFDLElBQUksQ0FBTCxJQUFBO0FBQTlCLE9BQVA7O0FBQ0YsU0FBQSxVQUFBO0FBQ0UsYUFBTztBQUFFLFFBQUEsUUFBRixRQUFBO0FBQW9CLFFBQUEsS0FBSyxFQUFFO0FBQTNCLE9BQVA7O0FBQ0YsU0FBQSxTQUFBO0FBQ0UsYUFBTztBQUFFLFFBQUEsUUFBUSxFQUFFLElBQUksQ0FBaEIsSUFBQTtBQUF1QixRQUFBLEtBQUssRUFBRSxDQUFDLElBQUksQ0FBTCxJQUFBO0FBQTlCLE9BQVA7QUFOSjtBQVFEOztBQUVELGVBQWUsSUFBZixRQUFlLEVBQWYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaWN0LCBPcHRpb24sIFByZXNlbnRBcnJheSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmltcG9ydCB7IFBhcnNlck5vZGVCdWlsZGVyIH0gZnJvbSAnLi4vcGFyc2VyJztcbmltcG9ydCB7IFNvdXJjZUxvY2F0aW9uIH0gZnJvbSAnLi4vc291cmNlL2xvY2F0aW9uJztcbmltcG9ydCB7IFNvdXJjZU9mZnNldCwgU291cmNlU3BhbiB9IGZyb20gJy4uL3NvdXJjZS9zcGFuJztcbmltcG9ydCAqIGFzIEFTVHYxIGZyb20gJy4vYXBpJztcbmltcG9ydCB7IFBhdGhFeHByZXNzaW9uSW1wbFYxIH0gZnJvbSAnLi9sZWdhY3ktaW50ZXJvcCc7XG5cbmNvbnN0IERFRkFVTFRfU1RSSVAgPSB7XG4gIGNsb3NlOiBmYWxzZSxcbiAgb3BlbjogZmFsc2UsXG59O1xuXG4vKipcbiAqIFRoZSBQYXJzZXIgQnVpbGRlciBkaWZmZXJlbnRpYXRlcyBmcm9tIHRoZSBwdWJsaWMgYnVpbGRlciBBUEkgYnk6XG4gKlxuICogMS4gT2ZmZXJpbmcgZmV3ZXIgZGlmZmVyZW50IHdheXMgdG8gaW5zdGFudGlhdGUgbm9kZXNcbiAqIDIuIE1hbmRhdGluZyBzb3VyY2UgbG9jYXRpb25zXG4gKi9cbmNsYXNzIEJ1aWxkZXJzIHtcbiAgcG9zKGxpbmU6IG51bWJlciwgY29sdW1uOiBudW1iZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGluZSxcbiAgICAgIGNvbHVtbixcbiAgICB9O1xuICB9XG5cbiAgYmxvY2tJdHNlbGYoe1xuICAgIGJvZHksXG4gICAgYmxvY2tQYXJhbXMsXG4gICAgY2hhaW5lZCA9IGZhbHNlLFxuICAgIGxvYyxcbiAgfToge1xuICAgIGJvZHk/OiBBU1R2MS5TdGF0ZW1lbnRbXTtcbiAgICBibG9ja1BhcmFtcz86IHN0cmluZ1tdO1xuICAgIGNoYWluZWQ/OiBib29sZWFuO1xuICAgIGxvYzogU291cmNlU3BhbjtcbiAgfSk6IEFTVHYxLkJsb2NrIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0Jsb2NrJyxcbiAgICAgIGJvZHk6IGJvZHkgfHwgW10sXG4gICAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgICBjaGFpbmVkLFxuICAgICAgbG9jLFxuICAgIH07XG4gIH1cblxuICB0ZW1wbGF0ZSh7XG4gICAgYm9keSxcbiAgICBibG9ja1BhcmFtcyxcbiAgICBsb2MsXG4gIH06IHtcbiAgICBib2R5PzogQVNUdjEuU3RhdGVtZW50W107XG4gICAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXTtcbiAgICBsb2M6IFNvdXJjZVNwYW47XG4gIH0pOiBBU1R2MS5UZW1wbGF0ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdUZW1wbGF0ZScsXG4gICAgICBib2R5OiBib2R5IHx8IFtdLFxuICAgICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zIHx8IFtdLFxuICAgICAgbG9jLFxuICAgIH07XG4gIH1cblxuICBtdXN0YWNoZSh7XG4gICAgcGF0aCxcbiAgICBwYXJhbXMsXG4gICAgaGFzaCxcbiAgICB0cnVzdGluZyxcbiAgICBsb2MsXG4gICAgc3RyaXAgPSBERUZBVUxUX1NUUklQLFxuICB9OiB7XG4gICAgcGF0aDogQVNUdjEuRXhwcmVzc2lvbjtcbiAgICBwYXJhbXM6IEFTVHYxLkV4cHJlc3Npb25bXTtcbiAgICBoYXNoOiBBU1R2MS5IYXNoO1xuICAgIHRydXN0aW5nOiBib29sZWFuO1xuICAgIGxvYzogU291cmNlU3BhbjtcbiAgICBzdHJpcDogQVNUdjEuU3RyaXBGbGFncztcbiAgfSk6IEFTVHYxLk11c3RhY2hlU3RhdGVtZW50IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ011c3RhY2hlU3RhdGVtZW50JyxcbiAgICAgIHBhdGgsXG4gICAgICBwYXJhbXMsXG4gICAgICBoYXNoLFxuICAgICAgZXNjYXBlZDogIXRydXN0aW5nLFxuICAgICAgdHJ1c3RpbmcsXG4gICAgICBsb2MsXG4gICAgICBzdHJpcDogc3RyaXAgfHwgeyBvcGVuOiBmYWxzZSwgY2xvc2U6IGZhbHNlIH0sXG4gICAgfTtcbiAgfVxuXG4gIGJsb2NrKHtcbiAgICBwYXRoLFxuICAgIHBhcmFtcyxcbiAgICBoYXNoLFxuICAgIGRlZmF1bHRCbG9jayxcbiAgICBlbHNlQmxvY2sgPSBudWxsLFxuICAgIGxvYyxcbiAgICBvcGVuU3RyaXAgPSBERUZBVUxUX1NUUklQLFxuICAgIGludmVyc2VTdHJpcCA9IERFRkFVTFRfU1RSSVAsXG4gICAgY2xvc2VTdHJpcCA9IERFRkFVTFRfU1RSSVAsXG4gIH06IHtcbiAgICBwYXRoOiBBU1R2MS5QYXRoRXhwcmVzc2lvbjtcbiAgICBwYXJhbXM6IEFTVHYxLkV4cHJlc3Npb25bXTtcbiAgICBoYXNoOiBBU1R2MS5IYXNoO1xuICAgIGRlZmF1bHRCbG9jazogQVNUdjEuQmxvY2s7XG4gICAgZWxzZUJsb2NrPzogT3B0aW9uPEFTVHYxLkJsb2NrPjtcbiAgICBsb2M6IFNvdXJjZVNwYW47XG4gICAgb3BlblN0cmlwOiBBU1R2MS5TdHJpcEZsYWdzO1xuICAgIGludmVyc2VTdHJpcDogQVNUdjEuU3RyaXBGbGFncztcbiAgICBjbG9zZVN0cmlwOiBBU1R2MS5TdHJpcEZsYWdzO1xuICB9KTogQVNUdjEuQmxvY2tTdGF0ZW1lbnQge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQmxvY2tTdGF0ZW1lbnQnLFxuICAgICAgcGF0aDogcGF0aCxcbiAgICAgIHBhcmFtcyxcbiAgICAgIGhhc2gsXG4gICAgICBwcm9ncmFtOiBkZWZhdWx0QmxvY2ssXG4gICAgICBpbnZlcnNlOiBlbHNlQmxvY2ssXG4gICAgICBsb2M6IGxvYyxcbiAgICAgIG9wZW5TdHJpcDogb3BlblN0cmlwLFxuICAgICAgaW52ZXJzZVN0cmlwOiBpbnZlcnNlU3RyaXAsXG4gICAgICBjbG9zZVN0cmlwOiBjbG9zZVN0cmlwLFxuICAgIH07XG4gIH1cblxuICBjb21tZW50KHZhbHVlOiBzdHJpbmcsIGxvYzogU291cmNlT2Zmc2V0KTogUGFyc2VyTm9kZUJ1aWxkZXI8QVNUdjEuQ29tbWVudFN0YXRlbWVudD4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQ29tbWVudFN0YXRlbWVudCcsXG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBsb2MsXG4gICAgfTtcbiAgfVxuXG4gIG11c3RhY2hlQ29tbWVudCh2YWx1ZTogc3RyaW5nLCBsb2M6IFNvdXJjZVNwYW4pOiBBU1R2MS5NdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnQge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnTXVzdGFjaGVDb21tZW50U3RhdGVtZW50JyxcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGxvYyxcbiAgICB9O1xuICB9XG5cbiAgY29uY2F0KFxuICAgIHBhcnRzOiBQcmVzZW50QXJyYXk8QVNUdjEuVGV4dE5vZGUgfCBBU1R2MS5NdXN0YWNoZVN0YXRlbWVudD4sXG4gICAgbG9jOiBTb3VyY2VTcGFuXG4gICk6IEFTVHYxLkNvbmNhdFN0YXRlbWVudCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdDb25jYXRTdGF0ZW1lbnQnLFxuICAgICAgcGFydHMsXG4gICAgICBsb2MsXG4gICAgfTtcbiAgfVxuXG4gIGVsZW1lbnQoe1xuICAgIHRhZyxcbiAgICBzZWxmQ2xvc2luZyxcbiAgICBhdHRycyxcbiAgICBibG9ja1BhcmFtcyxcbiAgICBtb2RpZmllcnMsXG4gICAgY29tbWVudHMsXG4gICAgY2hpbGRyZW4sXG4gICAgbG9jLFxuICB9OiBCdWlsZEVsZW1lbnRPcHRpb25zKTogQVNUdjEuRWxlbWVudE5vZGUge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnRWxlbWVudE5vZGUnLFxuICAgICAgdGFnLFxuICAgICAgc2VsZkNsb3Npbmc6IHNlbGZDbG9zaW5nLFxuICAgICAgYXR0cmlidXRlczogYXR0cnMgfHwgW10sXG4gICAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgICBtb2RpZmllcnM6IG1vZGlmaWVycyB8fCBbXSxcbiAgICAgIGNvbW1lbnRzOiAoY29tbWVudHMgYXMgQVNUdjEuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10pIHx8IFtdLFxuICAgICAgY2hpbGRyZW46IGNoaWxkcmVuIHx8IFtdLFxuICAgICAgbG9jLFxuICAgIH07XG4gIH1cblxuICBlbGVtZW50TW9kaWZpZXIoe1xuICAgIHBhdGgsXG4gICAgcGFyYW1zLFxuICAgIGhhc2gsXG4gICAgbG9jLFxuICB9OiB7XG4gICAgcGF0aDogQVNUdjEuUGF0aEV4cHJlc3Npb24gfCBBU1R2MS5TdWJFeHByZXNzaW9uO1xuICAgIHBhcmFtczogQVNUdjEuRXhwcmVzc2lvbltdO1xuICAgIGhhc2g6IEFTVHYxLkhhc2g7XG4gICAgbG9jOiBTb3VyY2VTcGFuO1xuICB9KTogQVNUdjEuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0VsZW1lbnRNb2RpZmllclN0YXRlbWVudCcsXG4gICAgICBwYXRoLFxuICAgICAgcGFyYW1zLFxuICAgICAgaGFzaCxcbiAgICAgIGxvYyxcbiAgICB9O1xuICB9XG5cbiAgYXR0cih7XG4gICAgbmFtZSxcbiAgICB2YWx1ZSxcbiAgICBsb2MsXG4gIH06IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdmFsdWU6IEFTVHYxLkF0dHJOb2RlWyd2YWx1ZSddO1xuICAgIGxvYzogU291cmNlU3BhbjtcbiAgfSk6IEFTVHYxLkF0dHJOb2RlIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0F0dHJOb2RlJyxcbiAgICAgIG5hbWU6IG5hbWUsXG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBsb2MsXG4gICAgfTtcbiAgfVxuXG4gIHRleHQoeyBjaGFycywgbG9jIH06IHsgY2hhcnM6IHN0cmluZzsgbG9jOiBTb3VyY2VTcGFuIH0pOiBBU1R2MS5UZXh0Tm9kZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdUZXh0Tm9kZScsXG4gICAgICBjaGFycyxcbiAgICAgIGxvYyxcbiAgICB9O1xuICB9XG5cbiAgc2V4cHIoe1xuICAgIHBhdGgsXG4gICAgcGFyYW1zLFxuICAgIGhhc2gsXG4gICAgbG9jLFxuICB9OiB7XG4gICAgcGF0aDogQVNUdjEuUGF0aEV4cHJlc3Npb247XG4gICAgcGFyYW1zOiBBU1R2MS5FeHByZXNzaW9uW107XG4gICAgaGFzaDogQVNUdjEuSGFzaDtcbiAgICBsb2M6IFNvdXJjZVNwYW47XG4gIH0pOiBBU1R2MS5TdWJFeHByZXNzaW9uIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ1N1YkV4cHJlc3Npb24nLFxuICAgICAgcGF0aCxcbiAgICAgIHBhcmFtcyxcbiAgICAgIGhhc2gsXG4gICAgICBsb2MsXG4gICAgfTtcbiAgfVxuXG4gIHBhdGgoe1xuICAgIGhlYWQsXG4gICAgdGFpbCxcbiAgICBsb2MsXG4gIH06IHtcbiAgICBoZWFkOiBBU1R2MS5QYXRoSGVhZDtcbiAgICB0YWlsOiBzdHJpbmdbXTtcbiAgICBsb2M6IFNvdXJjZVNwYW47XG4gIH0pOiBBU1R2MS5QYXRoRXhwcmVzc2lvbiB7XG4gICAgbGV0IHsgb3JpZ2luYWw6IG9yaWdpbmFsSGVhZCwgcGFydHM6IGhlYWRQYXJ0cyB9ID0gaGVhZFRvU3RyaW5nKGhlYWQpO1xuICAgIGxldCBwYXJ0cyA9IFsuLi5oZWFkUGFydHMsIC4uLnRhaWxdO1xuICAgIGxldCBvcmlnaW5hbCA9IFsuLi5vcmlnaW5hbEhlYWQsIC4uLnBhcnRzXS5qb2luKCcuJyk7XG5cbiAgICByZXR1cm4gbmV3IFBhdGhFeHByZXNzaW9uSW1wbFYxKG9yaWdpbmFsLCBoZWFkLCB0YWlsLCBsb2MpO1xuICB9XG5cbiAgaGVhZChoZWFkOiBzdHJpbmcsIGxvYzogU291cmNlU3Bhbik6IEFTVHYxLlBhdGhIZWFkIHtcbiAgICBpZiAoaGVhZFswXSA9PT0gJ0AnKSB7XG4gICAgICByZXR1cm4gdGhpcy5hdE5hbWUoaGVhZCwgbG9jKTtcbiAgICB9IGVsc2UgaWYgKGhlYWQgPT09ICd0aGlzJykge1xuICAgICAgcmV0dXJuIHRoaXMudGhpcyhsb2MpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy52YXIoaGVhZCwgbG9jKTtcbiAgICB9XG4gIH1cblxuICB0aGlzKGxvYzogU291cmNlU3Bhbik6IEFTVHYxLlBhdGhIZWFkIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ1RoaXNIZWFkJyxcbiAgICAgIGxvYyxcbiAgICB9O1xuICB9XG5cbiAgYXROYW1lKG5hbWU6IHN0cmluZywgbG9jOiBTb3VyY2VTcGFuKTogQVNUdjEuUGF0aEhlYWQge1xuICAgIC8vIHRoZSBgQGAgc2hvdWxkIGJlIGluY2x1ZGVkIHNvIHdlIGhhdmUgYSBjb21wbGV0ZSBzb3VyY2UgcmFuZ2VcbiAgICBhc3NlcnQobmFtZVswXSA9PT0gJ0AnLCBgY2FsbCBidWlsZGVycy5hdCgpIHdpdGggYSBzdHJpbmcgdGhhdCBzdGFydHMgd2l0aCAnQCdgKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQXRIZWFkJyxcbiAgICAgIG5hbWUsXG4gICAgICBsb2MsXG4gICAgfTtcbiAgfVxuXG4gIHZhcihuYW1lOiBzdHJpbmcsIGxvYzogU291cmNlU3Bhbik6IEFTVHYxLlBhdGhIZWFkIHtcbiAgICBhc3NlcnQobmFtZSAhPT0gJ3RoaXMnLCBgWW91IGNhbGxlZCBidWlsZGVycy52YXIoKSB3aXRoICd0aGlzJy4gQ2FsbCBidWlsZGVycy50aGlzIGluc3RlYWRgKTtcbiAgICBhc3NlcnQoXG4gICAgICBuYW1lWzBdICE9PSAnQCcsXG4gICAgICBgWW91IGNhbGxlZCBidWlsZGVycy52YXIoKSB3aXRoICcke25hbWV9Jy4gQ2FsbCBidWlsZGVycy5hdCgnJHtuYW1lfScpIGluc3RlYWRgXG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnVmFySGVhZCcsXG4gICAgICBuYW1lLFxuICAgICAgbG9jLFxuICAgIH07XG4gIH1cblxuICBoYXNoKHBhaXJzOiBBU1R2MS5IYXNoUGFpcltdLCBsb2M6IFNvdXJjZVNwYW4pOiBBU1R2MS5IYXNoIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0hhc2gnLFxuICAgICAgcGFpcnM6IHBhaXJzIHx8IFtdLFxuICAgICAgbG9jLFxuICAgIH07XG4gIH1cblxuICBwYWlyKHtcbiAgICBrZXksXG4gICAgdmFsdWUsXG4gICAgbG9jLFxuICB9OiB7XG4gICAga2V5OiBzdHJpbmc7XG4gICAgdmFsdWU6IEFTVHYxLkV4cHJlc3Npb247XG4gICAgbG9jOiBTb3VyY2VTcGFuO1xuICB9KTogQVNUdjEuSGFzaFBhaXIge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnSGFzaFBhaXInLFxuICAgICAga2V5OiBrZXksXG4gICAgICB2YWx1ZSxcbiAgICAgIGxvYyxcbiAgICB9O1xuICB9XG5cbiAgbGl0ZXJhbDxUIGV4dGVuZHMgQVNUdjEuTGl0ZXJhbD4oe1xuICAgIHR5cGUsXG4gICAgdmFsdWUsXG4gICAgbG9jLFxuICB9OiB7XG4gICAgdHlwZTogVFsndHlwZSddO1xuICAgIHZhbHVlOiBUWyd2YWx1ZSddO1xuICAgIGxvYz86IFNvdXJjZUxvY2F0aW9uO1xuICB9KTogVCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2YWx1ZSxcbiAgICAgIG9yaWdpbmFsOiB2YWx1ZSxcbiAgICAgIGxvYyxcbiAgICB9IGFzIFQ7XG4gIH1cblxuICB1bmRlZmluZWQoKTogQVNUdjEuVW5kZWZpbmVkTGl0ZXJhbCB7XG4gICAgcmV0dXJuIHRoaXMubGl0ZXJhbCh7IHR5cGU6ICdVbmRlZmluZWRMaXRlcmFsJywgdmFsdWU6IHVuZGVmaW5lZCB9KTtcbiAgfVxuXG4gIG51bGwoKTogQVNUdjEuTnVsbExpdGVyYWwge1xuICAgIHJldHVybiB0aGlzLmxpdGVyYWwoeyB0eXBlOiAnTnVsbExpdGVyYWwnLCB2YWx1ZTogbnVsbCB9KTtcbiAgfVxuXG4gIHN0cmluZyh2YWx1ZTogc3RyaW5nLCBsb2M6IFNvdXJjZVNwYW4pOiBBU1R2MS5TdHJpbmdMaXRlcmFsIHtcbiAgICByZXR1cm4gdGhpcy5saXRlcmFsKHsgdHlwZTogJ1N0cmluZ0xpdGVyYWwnLCB2YWx1ZSwgbG9jIH0pO1xuICB9XG5cbiAgYm9vbGVhbih2YWx1ZTogYm9vbGVhbiwgbG9jOiBTb3VyY2VTcGFuKTogQVNUdjEuQm9vbGVhbkxpdGVyYWwge1xuICAgIHJldHVybiB0aGlzLmxpdGVyYWwoeyB0eXBlOiAnQm9vbGVhbkxpdGVyYWwnLCB2YWx1ZSwgbG9jIH0pO1xuICB9XG5cbiAgbnVtYmVyKHZhbHVlOiBudW1iZXIsIGxvYzogU291cmNlU3Bhbik6IEFTVHYxLk51bWJlckxpdGVyYWwge1xuICAgIHJldHVybiB0aGlzLmxpdGVyYWwoeyB0eXBlOiAnTnVtYmVyTGl0ZXJhbCcsIHZhbHVlLCBsb2MgfSk7XG4gIH1cbn1cblxuLy8gTm9kZXNcblxuZXhwb3J0IHR5cGUgRWxlbWVudFBhcnRzID1cbiAgfCBbJ2F0dHJzJywgLi4uQXR0clNleHBbXV1cbiAgfCBbJ21vZGlmaWVycycsIC4uLk1vZGlmaWVyU2V4cFtdXVxuICB8IFsnYm9keScsIC4uLkFTVHYxLlN0YXRlbWVudFtdXVxuICB8IFsnY29tbWVudHMnLCAuLi5FbGVtZW50Q29tbWVudFtdXVxuICB8IFsnYXMnLCAuLi5zdHJpbmdbXV1cbiAgfCBbJ2xvYycsIFNvdXJjZUxvY2F0aW9uXTtcblxuZXhwb3J0IHR5cGUgUGF0aFNleHAgPSBzdHJpbmcgfCBbJ3BhdGgnLCBzdHJpbmcsIExvY1NleHA/XTtcblxuZXhwb3J0IHR5cGUgTW9kaWZpZXJTZXhwID1cbiAgfCBzdHJpbmdcbiAgfCBbUGF0aFNleHAsIExvY1NleHA/XVxuICB8IFtQYXRoU2V4cCwgQVNUdjEuRXhwcmVzc2lvbltdLCBMb2NTZXhwP11cbiAgfCBbUGF0aFNleHAsIEFTVHYxLkV4cHJlc3Npb25bXSwgRGljdDxBU1R2MS5FeHByZXNzaW9uPiwgTG9jU2V4cD9dO1xuXG5leHBvcnQgdHlwZSBBdHRyU2V4cCA9IFtzdHJpbmcsIEFTVHYxLkF0dHJOb2RlWyd2YWx1ZSddIHwgc3RyaW5nLCBMb2NTZXhwP107XG5cbmV4cG9ydCB0eXBlIExvY1NleHAgPSBbJ2xvYycsIFNvdXJjZUxvY2F0aW9uXTtcblxuZXhwb3J0IHR5cGUgRWxlbWVudENvbW1lbnQgPSBBU1R2MS5NdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnQgfCBTb3VyY2VMb2NhdGlvbiB8IHN0cmluZztcblxuZXhwb3J0IHR5cGUgU2V4cFZhbHVlID1cbiAgfCBzdHJpbmdcbiAgfCBBU1R2MS5FeHByZXNzaW9uW11cbiAgfCBEaWN0PEFTVHYxLkV4cHJlc3Npb24+XG4gIHwgTG9jU2V4cFxuICB8IFBhdGhTZXhwXG4gIHwgdW5kZWZpbmVkO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJ1aWxkRWxlbWVudE9wdGlvbnMge1xuICB0YWc6IHN0cmluZztcbiAgc2VsZkNsb3Npbmc6IGJvb2xlYW47XG4gIGF0dHJzOiBBU1R2MS5BdHRyTm9kZVtdO1xuICBtb2RpZmllcnM6IEFTVHYxLkVsZW1lbnRNb2RpZmllclN0YXRlbWVudFtdO1xuICBjaGlsZHJlbjogQVNUdjEuU3RhdGVtZW50W107XG4gIGNvbW1lbnRzOiBFbGVtZW50Q29tbWVudFtdO1xuICBibG9ja1BhcmFtczogc3RyaW5nW107XG4gIGxvYzogU291cmNlU3Bhbjtcbn1cblxuLy8gRXhwcmVzc2lvbnNcblxuZnVuY3Rpb24gaGVhZFRvU3RyaW5nKGhlYWQ6IEFTVHYxLlBhdGhIZWFkKTogeyBvcmlnaW5hbDogc3RyaW5nOyBwYXJ0czogc3RyaW5nW10gfSB7XG4gIHN3aXRjaCAoaGVhZC50eXBlKSB7XG4gICAgY2FzZSAnQXRIZWFkJzpcbiAgICAgIHJldHVybiB7IG9yaWdpbmFsOiBoZWFkLm5hbWUsIHBhcnRzOiBbaGVhZC5uYW1lXSB9O1xuICAgIGNhc2UgJ1RoaXNIZWFkJzpcbiAgICAgIHJldHVybiB7IG9yaWdpbmFsOiBgdGhpc2AsIHBhcnRzOiBbXSB9O1xuICAgIGNhc2UgJ1ZhckhlYWQnOlxuICAgICAgcmV0dXJuIHsgb3JpZ2luYWw6IGhlYWQubmFtZSwgcGFydHM6IFtoZWFkLm5hbWVdIH07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IEJ1aWxkZXJzKCk7XG4iXSwic291cmNlUm9vdCI6IiJ9